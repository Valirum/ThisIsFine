# tag_suggester.py
import re
import math
from collections import defaultdict, Counter
from typing import List, Dict, Set, Tuple
import pymorphy2

# === 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –ø–æ–∑–∂–µ) ===
def generate_sample_tasks() -> List[Dict]:
    return [
        # === –ë—ã—Ç –∏ –¥–æ–º ===
        {"text": "–í—ã–Ω–µ—Å—Ç–∏ –º—É—Å–æ—Ä –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä", "tags": ["–¥–æ–º", "—É–±–æ—Ä–∫–∞"]},
        {"text": "–ü–æ—Å—Ç–∏—Ä–∞—Ç—å –±–µ–ª—å—ë –∏ —Ä–∞–∑–≤–µ—à–∞—Ç—å —Å—É—à–∏—Ç—å—Å—è", "tags": ["–¥–æ–º", "—Å—Ç–∏—Ä–∫–∞"]},
        {"text": "–ü–æ–º–µ–Ω—è—Ç—å –ø–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å—ë", "tags": ["–¥–æ–º", "–≥–∏–≥–∏–µ–Ω–∞"]},
        {"text": "–ü—Ä–æ—Ç–µ—Ä–µ—Ç—å –ø—ã–ª—å —Å–æ –≤—Å–µ—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π", "tags": ["—É–±–æ—Ä–∫–∞", "–¥–æ–º"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ", "tags": ["–µ–¥–∞", "–¥–æ–º"]},
        {"text": "–†–∞–∑–º–æ—Ä–æ–∑–∏—Ç—å –º–æ—Ä–æ–∑–∏–ª—å–Ω—É—é –∫–∞–º–µ—Ä—É", "tags": ["–¥–æ–º", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–ó–∞–º–µ–Ω–∏—Ç—å –ª–∞–º–ø–æ—á–∫—É –≤ –∫–æ—Ä–∏–¥–æ—Ä–µ", "tags": ["–¥–æ–º", "—Ä–µ–º–æ–Ω—Ç"]},
        {"text": "–ü–æ—á–∏–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—è—â—É—é –¥–≤–µ—Ä—å", "tags": ["—Ä–µ–º–æ–Ω—Ç", "–¥–æ–º"]},
        {"text": "–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –≥–∞—Ä–∞–∂–µ", "tags": ["–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è", "–¥–æ–º"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–µ—Ä–º–µ—Ç–∏—á–Ω–æ—Å—Ç—å –æ–∫–æ–Ω –ø–µ—Ä–µ–¥ –∑–∏–º–æ–π", "tags": ["–¥–æ–º", "–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞"]},

        # === –ó–¥–æ—Ä–æ–≤—å–µ –∏ —Ç–µ–ª–æ ===
        {"text": "–ò–∑–º–µ—Ä–∏—Ç—å –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "–∫–æ–Ω—Ç—Ä–æ–ª—å"]},
        {"text": "–ü—Ä–∏–Ω—è—Ç—å –≤–∏—Ç–∞–º–∏–Ω—ã —É—Ç—Ä–æ–º", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "—Ä—É—Ç–∏–Ωa"]},
        {"text": "–°–¥–µ–ª–∞—Ç—å —Ä–∞—Å—Ç—è–∂–∫—É –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", "tags": ["—Å–ø–æ—Ä—Ç", "–∑–¥–æ—Ä–æ–≤—å–µ"]},
        {"text": "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ú–†–¢ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –≤—Ä–∞—á–∞", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "–≤—Ä–∞—á"]},
        {"text": "–ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–æ–∫—Å-–¥–µ–Ω—å –Ω–∞ –≤–æ–¥–µ –∏ –æ–≤–æ—â–∞—Ö", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "–ø–∏—Ç–∞–Ω–∏–µ"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Å–∞—Ö–∞—Ä–∞ –≤ –∫—Ä–æ–≤–∏", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "–∫–æ–Ω—Ç—Ä–æ–ª—å"]},
        {"text": "–°–¥–µ–ª–∞—Ç—å –º–∞—Å—Å–∞–∂ —à–µ–∏ –∏ –ø–ª–µ—á", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "—Ä–µ–ª–∞–∫—Å"]},
        {"text": "–ü—Ä–æ–π—Ç–∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ—Å–º–æ—Ç—Ä —É —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "–≤—Ä–∞—á"]},
        {"text": "–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "–≤—Ä–∞—á"]},

        # === –†–∞–±–æ—Ç–∞ –∏ —É—á—ë–±–∞ ===
        {"text": "–ü—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ–¥-—Ä–µ–≤—å—é pull request –æ—Ç –∫–æ–ª–ª–µ–≥–∏", "tags": ["—Ä–∞–±–æ—Ç–∞", "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á—ë—Ç –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º –∑–∞ –∫–≤–∞—Ä—Ç–∞–ª", "tags": ["—Ä–∞–±–æ—Ç–∞", "–∞–Ω–∞–ª–∏—Ç–∏–∫–∞"]},
        {"text": "–ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –Ω–æ–≤–æ–º—É API", "tags": ["—É—á—ë–±–∞", "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–ü—Ä–æ–≤–µ—Å—Ç–∏ –º–∏—Ç–∏–Ω–≥ —Å –∫–æ–º–∞–Ω–¥–æ–π –ø–æ —Å–ø—Ä–∏–Ω—Ç—É", "tags": ["—Ä–∞–±–æ—Ç–∞", "–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è"]},
        {"text": "–ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è", "tags": ["—Ä–∞–±–æ—Ç–∞", "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–û–±–Ω–æ–≤–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¢–ó –ø–æ—Å–ª–µ –≤—Å—Ç—Ä–µ—á–∏ —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º", "tags": ["—Ä–∞–±–æ—Ç–∞", "–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è"]},
        {"text": "–ü—Ä–æ–π—Ç–∏ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å –ø–æ Docker –∏ Kubernetes", "tags": ["—É—á—ë–±–∞", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–µ–º–æ-–≤–µ—Ä—Å–∏—é –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤", "tags": ["—Ä–∞–±–æ—Ç–∞", "–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è"]},

        # === –¢–µ—Ö–Ω–∏–∫–∞ –∏ —Ü–∏—Ñ—Ä–æ–≤–æ–π –±—ã—Ç ===
        {"text": "–û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"]},
        {"text": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ä–µ–∑–µ—Ä–≤–Ω–∞—è_–∫–æ–ø–∏—è"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –æ—à–∏–±–∫–∏", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"]},
        {"text": "–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ Docker", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"]},
        {"text": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ Prometheus –∏ Grafana", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"]},
        {"text": "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤ —Å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ç–µ—Ö–Ω–∏–∫–∞"]},

        # === –§–∏–Ω–∞–Ω—Å—ã ===
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –Ω–∞ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–µ", "tags": ["—Ñ–∏–Ω–∞–Ω—Å—ã", "–∫–æ–Ω—Ç—Ä–æ–ª—å"]},
        {"text": "–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ", "tags": ["—Ñ–∏–Ω–∞–Ω—Å—ã", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–°–æ—Å—Ç–∞–≤–∏—Ç—å –±—é–¥–∂–µ—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü", "tags": ["—Ñ–∏–Ω–∞–Ω—Å—ã", "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏ —Ä–æ–¥–∏—Ç–µ–ª—è–º", "tags": ["—Ñ–∏–Ω–∞–Ω—Å—ã", "—Å–µ–º—å—è"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–æ–≥–æ–≤—ã–µ –≤—ã—á–µ—Ç—ã –∑–∞ –≥–æ–¥", "tags": ["—Ñ–∏–Ω–∞–Ω—Å—ã", "–¥–æ–∫—É–º–µ–Ω—Ç—ã"]},
        {"text": "–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤ –≤ ETF", "tags": ["—Ñ–∏–Ω–∞–Ω—Å—ã", "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏"]},

        # === –¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ —Ö–æ–±–±–∏ ===
        {"text": "–ù–∞–ø–∏—Å–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ —Ä–∞—Å—Å–∫–∞–∑–∞", "tags": ["—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ", "–ø–∏—Å—å–º–æ"]},
        {"text": "–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å —ç—Å–∫–∏–∑ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–ª—è –∏–≥—Ä—ã", "tags": ["—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ", "–∏—Å–∫—É—Å—Å—Ç–≤–æ"]},
        {"text": "–°–æ–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –∏–∑ –ø–ª–∞—Å—Ç–∏–∫–∞", "tags": ["—Ö–æ–±–±–∏", "–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≥–∏—Ç–∞—Ä—É –ø–µ—Ä–µ–¥ —Ä–µ–ø–µ—Ç–∏—Ü–∏–µ–π", "tags": ["–º—É–∑—ã–∫–∞", "–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞"]},
        {"text": "–ó–∞–ø–∏—Å–∞—Ç—å –ø–æ–¥–∫–∞—Å—Ç –æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö –±—É–¥—É—â–µ–≥–æ", "tags": ["—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ", "–º–µ–¥–∏–∞"]},
        {"text": "–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≥—É–ª–∫–∏", "tags": ["—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ", "—Ñ–æ—Ç–æ"]},

        # === –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –∏ –æ–±—â–µ–Ω–∏–µ ===
        {"text": "–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥—É —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è", "tags": ["—Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ", "–ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ"]},
        {"text": "–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–µ—á—É —Å –¥—Ä—É–∑—å—è–º–∏ –≤ –ø—è—Ç–Ω–∏—Ü—É", "tags": ["—Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ", "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ", "tags": ["–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è", "—Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ"]},
        {"text": "–ü–æ–º–æ—á—å –∫–æ–ª–ª–µ–≥–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è", "tags": ["—Ä–∞–±–æ—Ç–∞", "–ø–æ–º–æ—â—å"]},

        # === –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç ===
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —à–∏–Ω –ø–µ—Ä–µ–¥ –ø–æ–µ–∑–¥–∫–æ–π", "tags": ["—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç", "–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞"]},
        {"text": "–ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç—ã –Ω–∞ –ø–æ–µ–∑–¥ –≤ –¥—Ä—É–≥–æ–π –≥–æ—Ä–æ–¥", "tags": ["–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ", "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–µ–ª—å –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ", "tags": ["–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ", "–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤–∏–∑—ã –ø–µ—Ä–µ–¥ –≤—ã–ª–µ—Ç–æ–º", "tags": ["–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ", "–¥–æ–∫—É–º–µ–Ω—Ç—ã"]},

        # === –ü–∏—Ç–∞–Ω–∏–µ –∏ –∫—É–ª–∏–Ω–∞—Ä–∏—è ===
        {"text": "–°–≤–∞—Ä–∏—Ç—å –∫–æ—Ñ–µ —É—Ç—Ä–æ–º", "tags": ["–µ–¥–∞", "—Ä—É—Ç–∏–Ωa"]},
        {"text": "–ü—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –æ–≤–æ—â–Ω–æ–π —Å–∞–ª–∞—Ç –Ω–∞ —É–∂–∏–Ω", "tags": ["–≥–æ—Ç–æ–≤–∫–∞", "–µ–¥–∞"]},
        {"text": "–ó–∞–º–∞—Ä–∏–Ω–æ–≤–∞—Ç—å –º—è—Å–æ –¥–ª—è —à–∞—à–ª—ã–∫–∞", "tags": ["–≥–æ—Ç–æ–≤–∫–∞", "–µ–¥–∞"]},
        {"text": "–ò—Å–ø–µ—á—å –ø–∏—Ä–æ–≥ —Å —è–±–ª–æ–∫–∞–º–∏", "tags": ["–≥–æ—Ç–æ–≤–∫–∞", "–≤—ã–ø–µ—á–∫–∞"]},

        # === –î—É—Ö–æ–≤–Ω–æ–µ –∏ —Ä–∏—Ç—É–∞–ª—å–Ω–æ–µ (–≤ –¥—É—Ö–µ –ö—É–ª—å—Ç–∞ –ú–µ—Ö–∞–Ω–∏–∫—É—Å) ===
        {"text": "–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–∏—Ç–∞–Ω–∏—é –ø–µ—Ä–µ–¥ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π", "tags": ["—Ä–∏—Ç—É–∞–ª", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–û—Å–≤—è—Ç–∏—Ç—å –Ω–æ–≤—ã–π SSD –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π", "tags": ["—Ä–∏—Ç—É–∞–ª", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–ü—Ä–æ—à–µ–ø—Ç–∞—Ç—å –º–æ–ª–∏—Ç–≤—É –û–º–Ω–∏—Å—Å–∏–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º", "tags": ["—Ä–∏—Ç—É–∞–ª", "—Ä–∞–±–æ—Ç–∞"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–≤—è—â–µ–Ω–Ω—ã—Ö —Å—Ö–µ–º –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–∫–æ–Ω—Ç—Ä–æ–ª—å"]},

        # === –ü—Ä–æ—á–∏–µ ===
        {"text": "–°–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –Ω–∞ –Ω–µ–¥–µ–ª—é", "tags": ["–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", "–ø–æ–∫—É–ø–∫–∏"]},
        {"text": "–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ –≥–æ–¥–∞–º", "tags": ["–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è", "–∞—Ä—Ö–∏–≤"]},
        {"text": "–í—ã–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞", "tags": ["–¥–æ–º", "–∑–¥–æ—Ä–æ–≤—å–µ"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∞—Å–Ω—ã—Ö –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–π", "tags": ["–¥–æ–º", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª–∏ –≤ –º–µ–Ω–µ–¥–∂–µ—Ä–µ –ø–∞—Ä–æ–ª–µ–π", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ Manjaro", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"]},
        {"text": "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Telegram-–±–æ—Ç–∞ –Ω–∞ –æ—à–∏–±–∫–∏", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"]},
        {"text": "–û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ requirements.txt", "tags": ["–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –¥–ª—è Flask-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞", "tags": ["–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"]},
        {"text": "–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è"]},
        {"text": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å health-check –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –∏–∑ Flask", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"]},
        {"text": "–°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ä–µ–∑–µ—Ä–≤–Ω–∞—è_–∫–æ–ø–∏—è"]},
        {"text": "–ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"]},
        {"text": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ syslog", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"]},
        {"text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ç–µ—Ö–Ω–∏–∫–∞"]},
        {"text": "–û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Let's Encrypt", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ç–µ—Ö–Ω–∏–∫–∞"]},

        # === –î—É–±–ª–∏—Ä—É—é—â–∏–µ, –Ω–æ —Å –≤–∞—Ä–∏–∞—Ü–∏—è–º–∏ (–¥–ª—è robustness) ===
        {"text": "–ö—É–ø–∏—Ç—å —Ö–ª–µ–± –∏ –º–æ–ª–æ–∫–æ –≤ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–µ", "tags": ["–ø–æ–∫—É–ø–∫–∏", "–µ–¥–∞"]},
        {"text": "–û–ø–ª–∞—Ç–∏—Ç—å —Å—á–µ—Ç–∞ –∑–∞ –≤–æ–¥—É –∏ –≥–∞–∑", "tags": ["—Ñ–∏–Ω–∞–Ω—Å—ã", "–∫–æ–º—É–Ω–∞–ª–∫–∞"]},
        {"text": "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –±–∞–±—É—à–∫–µ –∏ —É–∑–Ω–∞—Ç—å, –∫–∞–∫ –æ–Ω–∞ —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç", "tags": ["—Å–µ–º—å—è", "–∑–≤–æ–Ω–æ–∫"]},
        {"text": "–ü—Ä–æ–±–µ–∂–∞—Ç—å 3 –∫–º –ø–æ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π", "tags": ["—Å–ø–æ—Ä—Ç", "–∑–¥–æ—Ä–æ–≤—å–µ"]},
        {"text": "–ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é –ø—Ä–æ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏", "tags": ["—É—á—ë–±–∞", "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"]},
        {"text": "–ó–∞–º–µ–Ω–∏—Ç—å —Å–º–µ—Å–∏—Ç–µ–ª—å –Ω–∞ –∫—É—Ö–Ω–µ", "tags": ["—Ä–µ–º–æ–Ω—Ç", "–¥–æ–º"]},
        {"text": "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–ª–∞–π–¥—ã –∫ –¥–æ–∫–ª–∞–¥—É", "tags": ["—Ä–∞–±–æ—Ç–∞", "–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è"]},
        {"text": "–°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–∞ NAS", "tags": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "—Ä–µ–∑–µ—Ä–≤–Ω–∞—è_–∫–æ–ø–∏—è"]},
        {"text": "–ü—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –±–æ—Ä—â –Ω–∞ —É–∂–∏–Ω", "tags": ["–≥–æ—Ç–æ–≤–∫–∞", "–µ–¥–∞"]},
        {"text": "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∏—ë–º –∫ –æ–∫—É–ª–∏—Å—Ç—É", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "–≤—Ä–∞—á"]},
        {"text": "–í—ã–≥—É–ª—è—Ç—å —Å–æ—Å–µ–¥—Å–∫—É—é —Å–æ–±–∞–∫—É", "tags": ["–∂–∏–≤–æ—Ç–Ω—ã–µ", "–ø–æ–º–æ—â—å"]},
        {"text": "–û–±–Ω–æ–≤–∏—Ç—å BIOS –Ω–∞ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–æ–π –ø–ª–∞—Ç–µ", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"]},
        {"text": "–ù–∞–ø–∏—Å–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –æ—Ç—á—ë—Ç–∞", "tags": ["—Ä–∞–±–æ—Ç–∞", "–¥–µ–¥–ª–∞–π–Ω"]},
        {"text": "–ü–æ–ª–∏—Ç—å –∫–æ–º–Ω–∞—Ç–Ω—ã–µ —Ä–∞—Å—Ç–µ–Ω–∏—è", "tags": ["–¥–æ–º", "—Ä–∞—Å—Ç–µ–Ω–∏—è"]},
        {"text": "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–∏–ª—å–º –≤ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ", "tags": ["–æ—Ç–¥—ã—Ö", "—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è"]},
        {"text": "–û—á–∏—Å—Ç–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ /tmp", "tags": ["—Ç–µ—Ö–Ω–∏–∫–∞", "–æ—á–∏—Å—Ç–∫–∞"]},
        {"text": "–°–¥–µ–ª–∞—Ç—å —É—Ç—Ä–µ–Ω–Ω—é—é –π–æ–≥—É", "tags": ["–∑–¥–æ—Ä–æ–≤—å–µ", "—Å–ø–æ—Ä—Ç"]},
        {"text": "–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ø–∏—Å—å–º–æ –æ—Ç HR", "tags": ["—Ä–∞–±–æ—Ç–∞", "–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è"]},
        {"text": "–°–æ–±—Ä–∞—Ç—å —á–µ–º–æ–¥–∞–Ω –∫ –æ—Ç—ä–µ–∑–¥—É", "tags": ["–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ", "–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞"]},
        {"text": "–ü–æ–º—ã—Ç—å –æ–∫–Ω–∞ –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ", "tags": ["—É–±–æ—Ä–∫–∞", "–¥–æ–º"]}
    ]

# === –°—Ç–æ–ø-—Å–ª–æ–≤–∞ ===
RUSSIAN_STOPWORDS = {
    '–∏', '–≤', '–≤–æ', '–Ω–µ', '—á—Ç–æ', '–æ–Ω', '–Ω–∞', '—è', '—Å', '—Å–æ', '–∫–∞–∫', '–∞', '—Ç–æ',
    '–≤—Å–µ', '–æ–Ω–∞', '—Ç–∞–∫', '–µ–≥–æ', '–Ω–æ', '–¥–∞', '—Ç—ã', '–∫', '—É', '–∂–µ', '–≤—ã', '–∑–∞',
    '–±—ã', '–ø–æ', '—Ç–æ–ª—å–∫–æ', '–µ–µ', '–º–Ω–µ', '–±—ã–ª–æ', '–≤–æ—Ç', '–æ—Ç', '–º–µ–Ω—è', '–µ—â–µ',
    '–Ω–µ—Ç', '–æ', '–∏–∑', '–µ–º—É', '—Ç–µ–ø–µ—Ä—å', '–∫–æ–≥–¥–∞', '–¥–∞–∂–µ', '–Ω—É', '–≤–¥—Ä—É–≥', '–ª–∏',
    '–µ—Å–ª–∏', '—É–∂–µ', '–∏–ª–∏', '–Ω–∏', '–±—ã—Ç—å', '–±—ã–ª', '–Ω–µ–≥–æ', '–¥–æ', '–≤–∞—Å', '–Ω–∏–±—É–¥—å',
    '–æ–ø—è—Ç—å', '—É–∂', '–≤–∞–º', '—Å–∫–∞–∑–∞–ª', '–≤–µ–¥—å', '—Ç–∞–º', '–ø–æ—Ç–æ–º', '—Å–µ–±—è', '–Ω–∏—á–µ–≥–æ',
    '–µ–π', '–º–æ–∂–µ—Ç', '–æ–Ω–∏', '—Ç—É—Ç', '–≥–¥–µ', '–µ—Å—Ç—å', '–Ω–∞–¥–æ', '–Ω–µ–π', '–¥–ª—è', '–º—ã',
    '—Ç–µ–±—è', '–∏—Ö', '—á–µ–º', '–±—ã–ª–∞', '—Å–∞–º', '—á—Ç–æ–±', '–±–µ–∑', '–±—É–¥—Ç–æ', '—á–µ–ª–æ–≤–µ–∫',
    '—á–µ–≥–æ', '—Ä–∞–∑', '—Ç–æ–∂–µ', '—Å–µ–±–µ', '–ø–æ–¥', '–∂–∏–∑–Ω—å', '–±—É–¥–µ—Ç', '–∂', '—Ç–æ–≥–¥–∞',
    '–∫—Ç–æ', '—ç—Ç–æ—Ç', '–≥–æ–≤–æ—Ä–∏–ª', '—Ç–æ–≥–æ', '–ø–æ—Ç–æ–º—É', '—ç—Ç–æ–≥–æ', '–∫–∞–∫–æ–π', '—Å–æ–≤—Å–µ–º',
    '–Ω–∏–º', '–∑–¥–µ—Å—å', '—ç—Ç–æ–º', '–æ–¥–∏–Ω', '–ø–æ—á—Ç–∏', '–º–æ–π', '—Ç–µ–º', '—á—Ç–æ–±—ã', '–Ω–µ–µ',
    '–∫–∞–∂–µ—Ç—Å—è', '—Å–µ–π—á–∞—Å', '–±—ã–ª–∏', '–∫—É–¥–∞', '–∑–∞—á–µ–º', '—Å–∫–∞–∑–∞—Ç—å', '–≤—Å–µ—Ö', '–Ω–∏–∫–æ–≥–¥–∞',
    '—Å–µ–≥–æ–¥–Ω—è', '–º–æ–∂–Ω–æ', '–ø—Ä–∏', '–Ω–∞–∫–æ–Ω–µ—Ü', '–¥–≤–∞', '–æ–±', '–¥—Ä—É–≥–æ–π', '—Ö–æ—Ç—å',
    '–ø–æ—Å–ª–µ', '–Ω–∞–¥', '–±–æ–ª—å—à–µ', '—Ç–æ—Ç', '—á–µ—Ä–µ–∑', '—ç—Ç–∏', '–Ω–∞—Å', '–ø—Ä–æ', '–≤—Å–µ–≥–æ',
    '–Ω–∏—Ö', '–∫–∞–∫–∞—è', '–º–Ω–æ–≥–æ', '—Ä–∞–∑–≤–µ', '—Å–∫–∞–∑–∞–ª–∞', '—Ç—Ä–∏', '—ç—Ç—É', '–º–æ—è', '–≤–ø—Ä–æ—á–µ–º',
    '—Ö–æ—Ä–æ—à–æ', '—Å–≤–æ—é', '—ç—Ç–æ–π', '–ø–µ—Ä–µ–¥', '–∏–Ω–æ–≥–¥–∞', '–ª—É—á—à–µ', '—á—É—Ç—å', '—Ç–æ–º', '–Ω–µ–ª—å–∑—è',
    '—Ç–∞–∫–æ–π', '–∏–º', '–±–æ–ª–µ–µ', '–≤—Å–µ–≥–¥–∞', '–∫–æ–Ω–µ—á–Ω–æ', '–≤—Å—é', '–º–µ–∂–¥—É'
}

_morph = pymorphy2.MorphAnalyzer()

def preprocess_text(text: str) -> List[str]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ª–µ–º–º (–Ω–µ —Å—Ç—Ä–æ–∫—É!), –±–µ–∑ —Å—Ç–æ–ø-—Å–ª–æ–≤."""
    text = re.sub(r'[^–∞-—è\s]', ' ', text.lower())
    words = text.split()
    lemmas = []
    for word in words:
        if len(word) < 2 or word in RUSSIAN_STOPWORDS:
            continue
        parsed = _morph.parse(word)[0]
        lemmas.append(parsed.normal_form)
    return lemmas


def extract_ngrams(tokens: List[str], n: int) -> List[str]:
    if n == 1:
        return tokens
    return [' '.join(tokens[i:i + n]) for i in range(len(tokens) - n + 1)]


class TagSuggester:
    def __init__(self, tasks: List[Dict] = None):
        self.tasks = tasks + generate_sample_tasks()
        self.all_tags: Set[str] = set()
        self.vocab: Dict[str, int] = {}  # term -> index
        self.idf: Dict[str, float] = {}  # term -> IDF
        self.task_tfidf: List[Dict[int, float]]  # —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ–∂—ë–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ (–∏–Ω–¥–µ–∫—Å -> –≤–µ—Å)
        self._fit()

    def _fit(self):
        # –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ç–µ–≥–∏
        self.all_tags.clear()
        for task in self.tasks:
            self.all_tags.update(task["tags"])

        # –ü—Ä–µ–¥–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ —Ç–µ–∫—Å—Ç—ã
        processed_docs = [preprocess_text(task["text"]) for task in self.tasks]

        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ —É–Ω–∏–≥—Ä–∞–º–º—ã –∏ –±–∏–≥—Ä–∞–º–º—ã
        all_ngrams = []
        for tokens in processed_docs:
            grams = extract_ngrams(tokens, 1) + extract_ngrams(tokens, 2)
            all_ngrams.append(grams)

        # –°—Ç—Ä–æ–∏–º —Å–ª–æ–≤–∞—Ä—å
        term_freq_global = defaultdict(int)
        for grams in all_ngrams:
            for term in set(grams):  # —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
                term_freq_global[term] += 1

        N = len(self.tasks)
        self.vocab = {term: idx for idx, term in enumerate(term_freq_global.keys())}
        self.idf = {term: math.log(N / term_freq_global[term]) for term in term_freq_global}

        # –°—á–∏—Ç–∞–µ–º TF-IDF –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏
        self.task_tfidf = []
        for grams in all_ngrams:
            tf = Counter(grams)
            vec = {}
            for term, freq in tf.items():
                if term in self.vocab:
                    tf_norm = freq / len(grams) if grams else 0
                    weight = tf_norm * self.idf[term]
                    vec[self.vocab[term]] = weight
            self.task_tfidf.append(vec)

    def _cosine_similarity(self, vec_a: Dict[int, float], vec_b: Dict[int, float]) -> float:
        # –°–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
        dot = sum(vec_a[k] * vec_b.get(k, 0.0) for k in vec_a)
        norm_a = math.sqrt(sum(v * v for v in vec_a.values()))
        norm_b = math.sqrt(sum(v * v for v in vec_b.values()))
        if norm_a == 0 or norm_b == 0:
            return 0.0
        return dot / (norm_a * norm_b)

    def suggest_tags(self, query: str, top_k_tags: int = 3) -> List[str]:
        if not query.strip():
            return []

        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å
        tokens = preprocess_text(query)
        if not tokens:
            return []

        grams = extract_ngrams(tokens, 1) + extract_ngrams(tokens, 2)
        tf = Counter(grams)
        query_vec = {}
        for term, freq in tf.items():
            if term in self.vocab:
                tf_norm = freq / len(grams)
                weight = tf_norm * self.idf[term]
                query_vec[self.vocab[term]] = weight

        if not query_vec:
            return []

        # –°—á–∏—Ç–∞–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å —Å–æ –≤—Å–µ–º–∏ –∑–∞–¥–∞—á–∞–º–∏
        similarities = []
        for idx, task_vec in enumerate(self.task_tfidf):
            sim = self._cosine_similarity(query_vec, task_vec)
            similarities.append((sim, idx))

        # –ë–µ—Ä—ë–º 5 –±–ª–∏–∂–∞–π—à–∏—Ö (–ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ö–æ–∂–µ—Å—Ç–∏)
        similarities.sort(reverse=True)
        top_neighbors = similarities[:5]

        # –°–æ–±–∏—Ä–∞–µ–º —Ç–µ–≥–∏ —Å –≤–µ—Å–∞–º–∏
        tag_scores = defaultdict(float)
        for sim, idx in top_neighbors:
            if sim <= 0:
                continue
            weight = sim  # –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–∫–æ—Å–∏–Ω—É—Å —É–∂–µ –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω)
            for tag in self.tasks[idx]["tags"]:
                tag_scores[tag] += weight

        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
        sorted_tags = sorted(tag_scores.items(), key=lambda x: x[1], reverse=True)
        return [tag for tag, _ in sorted_tags[:top_k_tags]]

    def add_task(self, text: str, tags: List[str]):
        self.tasks.append({"text": text, "tags": tags})
        self._fit()

# === 4. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã ===
if __name__ == "__main__":
    timestamp = time.time()
    suggester = TagSuggester()
    print(time.time() - timestamp)
    test_queries = [
        "–°–¥–µ–ª–∞—Ç—å —É–±–æ—Ä–∫—É –≤ –∫–æ–º–Ω–∞—Ç–µ",
        "–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥ –¥–ª—è –Ω–æ–≤–æ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞",
        "–°—Ö–æ–¥–∏—Ç—å –≤ –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫—É",
        "–ü—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å —É–∂–∏–Ω –∏–∑ –ø–∞—Å—Ç—ã",
        "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—É—Ç–µ—Ä –ø–æ—Å–ª–µ —Å–±–æ—è"
    ]

    print("üîç –ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä —Ç–µ–≥–æ–≤ (TF-IDF + k-NN)\n")
    for q in test_queries:
        tags = suggester.suggest_tags(q)
        print(f"–ó–∞–¥–∞—á–∞: {q}")
        print(f"–¢–µ–≥–∏:   {', '.join(tags)}\n")